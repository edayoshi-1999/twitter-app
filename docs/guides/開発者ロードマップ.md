# Twitter クローン開発ロードマップ

## 📊 プロジェクト進捗状況

**最終更新日**: 2025-11-16
**現在のフェーズ**: フェーズ2 - 基本機能開発（TDD実践）

---

## ✅ 完了したタスク

### フェーズ1: プロジェクトセットアップ

#### タスク1: プロジェクト初期化
- ✅ Laravelプロジェクトの作成
- ✅ Reactプロジェクトの作成（Vite）
- ✅ 基本的な設定ファイルの構成

#### タスク2: データベース設計
- ✅ usersテーブルの設計
- ✅ tweetsテーブルの設計
- ✅ マイグレーションファイルの作成

#### タスク3: モデル作成
- ✅ Userモデルの作成
- ✅ Tweetモデルの作成
- ✅ モデルファクトリーの作成

#### タスク4: 開発環境の構築
- ✅ Docker環境のセットアップ（Docker Compose）
- ✅ PostgreSQLデータベース接続の確認
- ✅ CORS設定の準備

#### タスク5: Docker Compose統合と動作確認
- ✅ Nginx、Laravel、React、PostgreSQLの統合
- ✅ Docker環境での動作確認ドキュメント作成

### フェーズ2: 基本機能開発（TDD実践）

#### ✅ タスク6: 最初のTDDサイクル（ツイート投稿機能）
**完了日**: 2025-11-16
**ブランチ**: `claude/tdd-tweet-posting-01KCy6vyCttUPuDkWG5Ndqj6`

**実施内容**:

1. **Step 1: Red（失敗するテストを書く）**
   - ✅ `tests/Feature/Tweet/TweetTest.php` を作成
   - ✅ 4つのテストケースを実装：
     - 認証されていないユーザーはツイートを投稿できない（401）
     - 認証済みユーザーはツイートを投稿できる（201）
     - ツイート本文が空の場合バリデーションエラー（422）
     - ツイート本文が280文字を超える場合バリデーションエラー（422）

2. **Step 2: Green（テストを通す最小限の実装）**
   - ✅ `app/Http/Requests/StoreTweetRequest.php` を作成（バリデーションロジック）
   - ✅ `app/Http/Controllers/TweetController.php` を作成（storeメソッド）
   - ✅ `routes/api.php` にルート定義を追加（`POST /api/tweets`）
   - ✅ UserモデルにtweetsリレーションとHasApiTokensトレイトを追加
   - ✅ Laravel Sanctumのインストールと設定

3. **Step 3: Refactor（リファクタリング）**
   - ✅ マジックナンバー（280）を定数化（`MAX_TWEET_LENGTH`）
   - ✅ Laravel Pintでコードスタイルを修正

**成果物**:
- フィーチャーテスト（4ケース）
- FormRequest（バリデーション分離）
- Controller（薄いコントローラー）
- API ルート定義

**学んだこと**:
- TDDの「Red → Green → Refactor」サイクルの実践
- Laravel Pestによるテスト駆動開発
- FormRequestによるバリデーション分離
- Controllerの責務（薄く保つ）
- Laravel Sanctumの基本的な設定

**注意点**:
- テスト実行にはDocker Compose環境でのPostgreSQL接続が必要
- 現在の実装は簡易的な認証（actingAs）を使用
- DDD（ドメイン駆動設計）の本格導入はタスク7以降

---

## 🚧 進行中のタスク

なし

---

## 📋 次のタスク

### タスク7: Laravel Sanctum認証の本格導入
**優先度**: 高
**推定工数**: 4時間

**目的**: SPA認証（Cookieベース）の実装

**実施内容**:
1. Sanctumの詳細設定
2. ユーザー登録エンドポイントの実装（TDD）
3. ログインエンドポイントの実装（TDD）
4. ログアウトエンドポイントの実装（TDD）
5. 認証ミドルウェアの設定

**成果物**:
- ユーザー登録API（`POST /api/register`）
- ログインAPI（`POST /api/login`）
- ログアウトAPI（`POST /api/logout`）
- 認証済みユーザー情報取得API（`GET /api/user`）
- フィーチャーテスト（認証関連）

---

### タスク8: ツイート一覧表示機能
**優先度**: 高
**推定工数**: 3時間

**目的**: ツイート一覧を取得するAPI実装

**実施内容**:
1. ツイート一覧取得エンドポイントの実装（TDD）
2. ページネーションの実装
3. ユーザー情報を含むレスポンス
4. 投稿日時の降順でソート

**成果物**:
- ツイート一覧取得API（`GET /api/tweets`）
- フィーチャーテスト（一覧取得）

---

### タスク9: ツイート削除機能
**優先度**: 中
**推定工数**: 2時間

**目的**: 自分のツイートを削除する機能

**実施内容**:
1. ツイート削除エンドポイントの実装（TDD）
2. 認可チェック（自分のツイートのみ削除可能）
3. ソフトデリート vs ハードデリートの検討

**成果物**:
- ツイート削除API（`DELETE /api/tweets/{id}`）
- フィーチャーテスト（削除機能）

---

### タスク10: React側 - ツイート投稿フォーム
**優先度**: 高
**推定工数**: 4時間

**目的**: フロントエンドでのツイート投稿機能実装

**実施内容**:
1. TweetFormコンポーネントの作成
2. Axiosを使用したAPI通信
3. ローディング状態管理
4. エラーハンドリング
5. TypeScript型定義
6. Tailwind CSSでスタイリング

**成果物**:
- `TweetForm.tsx`
- カスタムフック（`useTweetPost.ts`）
- 型定義（`types/tweet.ts`）

---

## 🎯 今後の予定

### フェーズ3: 応用機能開発

- タスク11: いいね機能（TDD）
- タスク12: リツイート機能（TDD）
- タスク13: リプライ機能（TDD）
- タスク14: フォロー機能（TDD）
- タスク15: タイムライン表示機能（TDD）
- タスク16: ユーザープロフィールページ

### フェーズ4: DDD本格導入

- タスク17: DDDレイヤード アーキテクチャへのリファクタリング
- タスク18: Value Objectの導入（TweetBody, EmailAddress, etc.）
- タスク19: Entityの分離
- タスク20: UseCaseパターンの導入
- タスク21: Repositoryパターンの本格実装

### フェーズ5: 最適化とデプロイ

- タスク22: パフォーマンスチューニング
- タスク23: E2Eテストの追加
- タスク24: CI/CDパイプラインの構築
- タスク25: 本番環境へのデプロイ

---

## 📈 進捗状況サマリー

| フェーズ | 完了タスク数 | 総タスク数 | 進捗率 |
|---------|------------|-----------|--------|
| フェーズ1: プロジェクトセットアップ | 5 | 5 | 100% |
| フェーズ2: 基本機能開発 | 1 | 6 | 17% |
| フェーズ3: 応用機能開発 | 0 | 6 | 0% |
| フェーズ4: DDD本格導入 | 0 | 5 | 0% |
| フェーズ5: 最適化とデプロイ | 0 | 4 | 0% |
| **合計** | **6** | **26** | **23%** |

---

## 🔧 技術スタック（再確認）

### フロントエンド
- React 18+ with TypeScript
- Vite（ビルドツール）
- Tailwind CSS（スタイリング）
- Axios（HTTP クライアント）
- Vitest + React Testing Library（テスト）

### バックエンド
- Laravel 11
- PHP 8.2+
- Laravel Sanctum（SPA認証）
- Pest（テストフレームワーク）
- Laravel Pint（コードスタイル）

### インフラ
- Docker + Docker Compose
- PostgreSQL 16
- Nginx（リバースプロキシ）

---

## 📝 メモ

### 課題と対応方針

1. **データベース接続の問題**
   - 現在の環境ではPostgreSQLへの接続ができない状態
   - Docker Compose環境での実行が必要
   - テストの実行は Docker環境内で行う必要がある

2. **認証の段階的実装**
   - タスク6: 簡易的な認証（`actingAs`）
   - タスク7: Laravel Sanctumの本格導入

3. **DDDの段階的適用**
   - タスク6: シンプルな実装（Controller + Model + FormRequest）
   - タスク17以降: DDD本格導入（UseCase, Repository, Entity, Value Object）

---

**作成日**: 2025-11-16
**作成者**: Claude（AIアシスタント）
